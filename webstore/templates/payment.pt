<metal:main use-macro="load: main.pt">
    <div metal:fill-slot="content" class="container">
        <h2>Order details</h2>
        <div tal:switch="v['lic']">
            <span tal:case='"new"'>You ordered new license</span>
            <span tal:case='"upgrade"'>You will upgrade existing license $ {v['license']}</span>
        </div>
        <div>
            Order #${order.order_id} Customer: ${order.first_name} ${order.last_name}
            Email: ${order.email} Payment method: ${order.payment}
        </div>
        <table class='table table-striped'>
            <tr tal:repeat='item order.items'>
                <td>${item.sku}</td>
                <td>${item.product.name}</td>
                <td>$${item.price}</td>
            </tr>
            <tr><td colspan='2'>Total:</td><td>$${order.total}</td>
        </table>
        <div>
            Address 1: ${order.addr1}<br>
            Address 2: ${order.addr2}<br>
            City: ${order.city}<br>
            State / Province: ${order.state}<br>
            Zip / Postal Code: ${order.zipcode}<br>
            Country: ${order.country}<br>

            <div id='card_data'>
                Credit Card #: ${v['card']}
                Expiration Date: ${v['expire']}
                CVV2: ${v['cvv2']}
            </div>
        </div>
        Please, check carefully order details above and then proceed to checkout.
        <form id='payment-form' action='${braintree_url}' method='POST'>
            <input type='hidden' name='tr_data' value='${tr_data}' />
            <input type='hidden' name='transaction[credit_card][number]' id='braintree_credit_card_number' value="${v['card']}"/>
            <input type='hidden' name='transaction[credit_card][expiration_date]' id='braintree_credit_card_exp' value="${v['expire']}"/>
            <div class="form-actions">
                <button id='submit' type="submit" class="btn btn-primary">Checkout</button>
            </div>
        </form>
    </div>
</metal:main>